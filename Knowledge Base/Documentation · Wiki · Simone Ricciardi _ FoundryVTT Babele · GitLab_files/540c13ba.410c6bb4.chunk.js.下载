(this.webpackJsonp=this.webpackJsonp||[]).push([["540c13ba"],{tXF7:function(t,e,n){"use strict";n.d(e,"c",(function(){return O})),n.d(e,"g",(function(){return w})),n.d(e,"b",(function(){return _})),n.d(e,"a",(function(){return R})),n.d(e,"d",(function(){return C})),n.d(e,"f",(function(){return I})),n.d(e,"e",(function(){return H}));n("v2fZ"),n("LdIe"),n("z6RN"),n("PTOk"),n("3UXl"),n("iyoE"),n("ZzK0"),n("BzOf"),n("B++/"),n("47t/");var r=n("EmJ/"),o=n.n(r),s=n("v+Mp"),i=n("NmEs"),c=n("2ibD"),a=n("3twG");const l=["**","`","_","~~"],u=/^((\s{0,3}-+\s*-+\s*-+\s*[\s-]*)|(\s{0,3}\*+\s*\*+\s*\*+\s*[\s*]*))$/,d=/^(?<indent>\s+)(?<content>.)?/,f=/^(?<indent>\s*)(?<leader>((?<isUl>[*+-])|(?<isOl>\d+\.))( \[([xX~\s])\])?\s)(?<content>.)?/,h=/^\s{0,3}>\s?/;let g=!1;function p(t,e){return t.substring(e.selectionStart,e.selectionEnd)}function m(t,e){return`${t}\n${e}\n${t}`}function b(t,e){const n=function(t,e){return t.substring(Math.max(0,e.selectionStart-1),e.selectionStart)}(t,e),r=function(t,e){return t.substring(e.selectionEnd,Math.min(e.selectionEnd+1,t.length))}(t,e);return{"[":"]","(":")"}[n]===r}function v(t){const e=t.value,{selectionStart:n,selectionEnd:r}=t;let o="\n"===e[n]?n-1:n;o=e.lastIndexOf("\n",o)+1;let s=r===n?r:r-1;s=e.indexOf("\n",s),s<0&&(s=e.length);return{lines:e.substring(o,s).split("\n"),selectionStart:n,selectionEnd:r,startPos:o,endPos:s}}function S(t,e,n,r,o,s){let i=Math.max(r,e+o),c=Math.max(r,n+s);e===n?c=i:e===r&&(i=r),t.setSelectionRange(i,c)}function x(t){return{start:{row:(e=t.getSelection()).startLineNumber,column:e.startColumn},end:{row:e.endLineNumber,column:e.endColumn}};var e}function O({textArea:t,text:e,tag:n,cursorOffset:r,blockTag:o,selected:s="",wrap:c,select:u,editor:d}){var f;if(!n&&!o&&!s)return;let g=!1,p=!1,b=!1;const v=(s=null!==(f=function(t,e){if(!t||!e||!l.includes(e))return;const n=t.value.substring(t.selectionStart,t.selectionEnd);if(n.startsWith(e)&&n.endsWith(e))return;const r=Math.max(t.selectionStart-e.length,0),o=Math.min(t.selectionEnd+e.length,t.value.length),s=t.value.substring(r,o);return s.startsWith(e)&&s.endsWith(e)&&(t.selectionStart=r,t.selectionEnd=o),t.value.substring(t.selectionStart,t.selectionEnd)}(t,n))&&void 0!==f?f:s).length,{selectionStart:S,selectionEnd:O}=t||{};let w,E,j,k;if(s=s.toString(),d){const t=x(d);w=t.start,E=t.end}"[{text}](url)"===n&&Object(a.B)(s)&&(n="[text]({text})",u="text"),0===s.indexOf("\n")&&(p=!0,s=s.replace(/\n+/,"")),t?t.selectionEnd-t.selectionStart>s.replace(/\n$/,"").length&&(g=!0,s=s.replace(/\n$/,"")):d&&w.row!==E.row&&(g=!0,s=s.replace(/\n$/,""));const T=s.split("\n");d&&!c?(j=d.getValue().split("\n")[w.row],/^\s*$/.test(j)&&(b=!0)):t&&!c&&(j=t.value.substr(0,t.selectionStart).lastIndexOf("\n"),/^\s*$/.test(t.value.substring(j,t.selectionStart))&&(b=!0));const y=t&&0===t.selectionStart||d&&0===w.column&&0===w.row,P=c||b||y?"":"\n",{shouldUseSelectedWithoutTags:M,removeTagFromLine:A,shouldRemoveTagFromLine:D,getSelectedWithoutTags:_,shouldPreserveTextAreaSelection:R}=function({selected:t,tag:e,selectedSplit:n}){if("> "===e){const r=n.every((function(t){return h.test(t)}));return{getSelectedWithoutTags:function(){return t.slice(t.match(h)[0].length,t.length)},shouldUseSelectedWithoutTags:h.test(t),removeTagFromLine:function(t){return t.replace(h,"")},shouldRemoveTagFromLine:function(){return r},shouldPreserveTextAreaSelection:l.includes(e)&&t.length>0}}return{getSelectedWithoutTags:function(){return t.slice(e.length,t.length-e.length)},shouldUseSelectedWithoutTags:t.length>=2*e.length&&t.startsWith(e)&&t.endsWith(e)&&l.includes(e),removeTagFromLine:function(t){return t.replace(e,"")},shouldRemoveTagFromLine:function(t){return 0===t.indexOf(e)},shouldPreserveTextAreaSelection:l.includes(e)&&t.length>0}}({selected:s,tag:n,selectedSplit:T});if(k=T.length>1&&(!c||null!=o&&""!==o)?null!=o&&""!==o?d?function(t,e,n,r){const o=t.split("\n"),s=x(r);if(o[s.start.row-1]===e&&o[s.end.row+1]===e){if(null!==e){const t=o[s.end.row+1],e=new Range(o[s.start.row-1],0,s.end.row+1,t.length);r.getSelection().setSelectionRange(e)}return n}return m(e,n)}(e,o,s,d):function(t,e,n,r){return function(t,e){let n=t.substring(0,e.selectionStart);n=n.split("\n");const r=n[n.length-2];return void 0===r?"":r}(t,e)===n&&function(t,e){let n=t.substring(e.selectionEnd);return n=n.replace(/^\n/,""),n=n.split("\n"),n[0]}(t,e)===n?(null!=n&&(e.selectionStart=e.selectionStart-(n.length+1),e.selectionEnd=e.selectionEnd+(n.length+1)),r):m(n,r)}(e,t,o,s):T.map((function(t){return n.indexOf("{text}")>-1?n.replace("{text}",t):D(t)?A(t):String(n)+t})).join("\n"):n.indexOf("{text}")>-1?n.replace("{text}",(function(){return s.replace(/\\n/g,"\n").replace(/%br/g,"\\n")})):M?_():`${P}${n}${s}${c?n:""}`,p&&(k="\n"+k),g&&(k+="\n"),d?d.replaceSelectedText(k,u):Object(i.q)(t,k),R){const e=k.length-v;t.setSelectionRange(S,O+e)}else!function({textArea:t,tag:e,cursorOffset:n,positionBetweenTags:r,removedLastNewLine:o,select:s,editor:i,editorSelectionStart:c,editorSelectionEnd:a}){let l;if(!t||t.setSelectionRange){if(s&&s.length>0){if(t){const n=t.selectionStart-(e.length-e.indexOf(s)),r=n+s.length;return t.setSelectionRange(n,r)}if(i)return void i.selectWithinSelection(s,e)}if(t){if(t.selectionStart===t.selectionEnd)l=r?t.selectionStart-e.length:t.selectionStart,o&&(l-=1),n&&(l-=n),t.setSelectionRange(l,l)}else i&&c.row===a.row&&r&&i.moveCursor(-1*e.length)}}({textArea:t,tag:n.replace("{text}",s),cursorOffset:r,positionBetweenTags:c&&0===s.length,removedLastNewLine:g,select:u,editor:d,editorSelectionStart:w,editorSelectionEnd:E})}function w({textArea:t,tag:e,cursorOffset:n,blockTag:r,wrap:s,select:i,tagContent:c,replaceText:a=!1}){const l=o()(t);t=l.get(0);const u=l.val(),d=a?"":p(u,t)||c;t.focus(),O({textArea:t,text:u,tag:e,cursorOffset:n,blockTag:r,selected:d,wrap:s,select:i}),t.click()}function E(t,e){return function(t){return!("Enter"!==t.key||t.altKey||t.ctrlKey||t.metaKey||t.shiftKey)}(t)&&e.selectionStart===e.selectionEnd&&!g}function j(t,e){const{indent:n,leader:r}=t.groups,[,o=""]=r.split(".");return`${n}${e}.${o}`}function k(t,e,n){const{indent:r}=e.groups,{lines:o,startPos:s,endPos:c}=function(t,e){const{selectionEnd:n,value:r}=t,o=r.indexOf("\n",n);if(-1===o)return{lines:[],startPos:-1,endPos:-1};const s=r.substring(o),i=[],c=o+1;let a=c;for(const t of s.replace(/^\n/,"").split("\n")){if(!e(t))break;i.push(t),a+=t.length+1}return{lines:i,startPos:c,endPos:a-1}}(t,(function(t){var e;const n=t.match(f),{indent:o,isOl:s}=null!==(e=null==n?void 0:n.groups)&&void 0!==e?e:{};return s&&o===r}));!function({textArea:t,lines:e,startPos:n,endPos:r,from:o}){if(0===e.length)return;const s=[],{selectionStart:c,selectionEnd:a}=t;let l=o;e.forEach((function(t){const e=t.match(f),n=t.slice(e.groups.leader.length+e.groups.indent.length),r=j(e,l)+n;s.push(r),l+=1})),t.focus(),t.setSelectionRange(n,r);const u=s.join("\n");Object(i.q)(t,u),t.setSelectionRange(c,a)}({textArea:t,lines:o,startPos:s,endPos:c,from:n})}function T(t,e){if(!gon.markdown_automatic_lists)return;if(!E(t,e))return;const n=v(e),r=n.lines[0],o=r.match(f);if(o){const{leader:s,indent:i,content:c,isOl:a}=o.groups,l=!c,d=s.length+i.length;if(n.selectionStart-n.startPos<d)return;if(l)return e.selectionStart=e.selectionStart-o[0].length,void k(e,o,1);let f;if(a){const t=function({groups:{leader:t}}){return parseInt(t,10)}(o)+1;f=j(o,t),k(e,o,t+1)}else{if(r.match(u))return;f=`${i}${s}`}f=f.replace(/\[[x~]\]/i,"[ ]"),t.preventDefault(),w({tag:f,textArea:e,blockTag:"",wrap:!1,select:"",tagContent:""})}}function y(t){var e,n;const r=this;null!==(e=(n=o()(r)).atwho)&&void 0!==e&&e.call(n,"isSelecting")||(T(t,r),t.isDefaultPrevented()||function(t,e){if(!gon.markdown_maintain_indentation)return;if(!E(t,e))return;const n=v(e),r=n.lines[0].match(d);if(!r)return;const{indent:o,content:s}=r.groups;n.selectionStart-n.startPos<o.length||(s?(t.preventDefault(),w({tag:o,textArea:e,blockTag:"",wrap:!1,select:"",tagContent:""})):e.selectionStart-=r[0].length)}(t,r),function(t,e){if(!gon.markdown_surround_selection)return;if(t.metaKey||t.ctrlKey)return;if(e.selectionStart===e.selectionEnd)return;const n={"*":"**{text}**",_:"_{text}_","`":"`{text}`","'":"'{text}'",'"':'"{text}"',"[":"[{text}]","{":"{{text}}","(":"({text})","<":"<{text}>"}[t.key];n&&(t.preventDefault(),w({tag:n,textArea:e,blockTag:"",wrap:!0,select:"",tagContent:""}))}(t,r))}function P(){g=!0}function M(){g=!1}function A(t){!function(t){const e=t.target;if(e.selectionStart===e.selectionEnd)return;const n=e.value;if(b(n,e))return;if(!t.clipboardData)return;let r=t.clipboardData.getData("text");if(r&&(r=r.trim(),Object(a.B)(r))){t.preventDefault(),t.stopImmediatePropagation();const o=`[${p(n,e)}](${r})`;Object(i.q)(e,o)}}(null!=t&&t.originalEvent?t.originalEvent:t)}function D(t){const e=t.closest(".md-area").find("textarea");if(e.length)switch(t.data("mdCommand")){case"indentLines":!function(t){const e=t.get(0),{lines:n,selectionStart:r,selectionEnd:o,startPos:s,endPos:c}=v(e),a=[];let l=0;e.focus(),e.setSelectionRange(s,c),n.forEach((function(t){t=" ".repeat(2)+t,l+=2,a.push(t)}));const u=a.join("\n");Object(i.q)(e,u),S(e,r,o,s,2,l)}(e);break;case"outdentLines":!function(t){const e=t.get(0),{lines:n,selectionStart:r,selectionEnd:o,startPos:s,endPos:c}=v(e),a=[];let l=0,u=-1,d=0;e.focus(),e.setSelectionRange(s,c),n.forEach((function(t){if(d=0,t.length>0){for(;d<2&&" "===t[d];)d+=1;d>0&&(t=t.slice(d),l+=d)}-1===u&&(u=d),a.push(t)}));const f=a.join("\n");l>0&&Object(i.q)(e,f),S(e,r,o,s,-u,-l)}(e);break;default:return w({textArea:e,tag:t.data("mdTag"),cursorOffset:t.data("mdCursorOffset"),blockTag:t.data("mdBlock"),wrap:!t.data("mdPrepend"),select:t.data("mdSelect"),tagContent:t.attr("data-md-tag-content")})}}function _(t){o()(".markdown-area",t).on("keydown",y).on("compositionstart",P).on("compositionend",M).on("paste",A).each((function(){s.default.initMarkdownEditorShortcuts(o()(this),D)}));return o()(t).off("click",".js-md").on("click",".js-md",(function(){return D(o()(this))}))}function R(t){o()(".js-md").off("click").on("click",(function(e){const{mdTag:n,mdBlock:r,mdPrepend:s,mdSelect:i}=o()(e.currentTarget).data();O({tag:n,blockTag:r,wrap:!s,select:i,selected:t.getSelectedText(),text:t.getValue(),editor:t}),t.focus()}))}function C(t){return o()(".markdown-area",t).off("keydown",y).off("compositionstart",P).off("compositionend",M).off("paste",A).each((function(){s.default.removeMarkdownEditorShortcuts(o()(this))})),o()(".js-md",t).off("click")}const I=async function(t,e=""){const{lines:n,startPos:r}=v(t);if(n>0)return null;const o=n[0];if(!/!\[.+?\]\(.+?\)/.test(o))return null;const s=t.selectionStart-r,i=o.substring(0,s).lastIndexOf("!"),a=o.substring(s).indexOf(")");if(i>=0&&a>=0){const t=o.substring(i,s+a+1),{data:n}=await c.a.post(e,{text:t}),r=(new DOMParser).parseFromString(n.body,"text/html").body.querySelector("a").getAttribute("href");if(r){const e=r.substring(r.lastIndexOf("/")+1);return{imageMarkdown:t,imageURL:r,filename:e}}}return null},H=function(t){var e;const n=Math.max(2,(null===(e=t.match(/```+/g))||void 0===e||null===(e=e.sort((function(t,e){return e.length-t.length}))[0])||void 0===e?void 0:e.length)||0)+1;return"`".repeat(n)}},"v+Mp":function(t,e,n){"use strict";n.r(e),n.d(e,"LOCAL_MOUSETRAP_DATA_KEY",(function(){return b})),n.d(e,"default",(function(){return S}));var r=n("8Doe"),o=n.n(r),s=(n("B++/"),n("z6RN"),n("47t/"),n("Tznw"),n("IYH6"),n("6yen"),n("OeRx"),n("l/dT"),n("RqS2"),n("Zy7a"),n("cjZU"),n("OAhk"),n("X42P"),n("mHhP"),n("fn0I"),n("UB/6"),n("imhG"),n("dHQd"),n("yoDG"),n("KeS/"),n("tWNI"),n("8d6S"),n("VwWG"),n("IYHS"),n("rIA9"),n("MViX"),n("zglm"),n("GDOA"),n("hlbI"),n("a0mT"),n("u3H1"),n("ta8/"),n("IKCR"),n("nmTw"),n("W2kU"),n("58fc"),n("7dtT"),n("Rhav"),n("uhEP"),n("eppl"),n("ZzK0"),n("BzOf"),n("EmJ/")),i=n.n(s),c=n("ewH8"),a=n("ygVz"),l=n("C83f"),u=n("O6Bj"),d=n("NmEs"),f=n("1OWu"),h=n("yQ8t"),g=n("3twG"),p=n("d08M"),m=n("wQDE");const b="local-mousetrap-instance";function v(t){const e=t.closest(".md-area").find(".js-md"),n=new Map;return e.each((function(){const t=i()(this),e=t.data("md-shortcuts");null!=e&&e.length&&n.set(t,e)})),n}class S{constructor(){var t;this.extensions=new Map,this.onToggleHelp=this.onToggleHelp.bind(this),this.helpModalElement=null,this.helpModalVueInstance=null,this.addAll([[p.Bb,this.onToggleHelp],[p.xb,S.focusSearchFile],[p.wb,S.focusSearch],[p.f,this.focusFilter.bind(this)],[p.Db,S.onTogglePerfBar],[p.H,S.hideAppearingContent],[p.zb,S.onToggleCanary],[p.h,function(){return Object(h.a)(".brand-logo")}],[p.G,function(){return Object(h.a)(".shortcuts-todos")}],[p.g,function(){return Object(h.a)(".dashboard-shortcuts-activity")}],[p.B,function(){return Object(h.a)(".dashboard-shortcuts-issues")}],[p.C,function(){return Object(h.a)(".dashboard-shortcuts-merge_requests, .js-merge-request-dashboard-shortcut")}],[p.E,function(){return Object(h.a)(".dashboard-shortcuts-review_requests, .js-merge-request-dashboard-shortcut")}],[p.D,function(){return Object(h.a)(".dashboard-shortcuts-projects")}],[p.A,function(){return Object(h.a)(".dashboard-shortcuts-groups")}],[p.i,function(){return Object(h.a)(".dashboard-shortcuts-milestones")}],[p.F,function(){return Object(h.a)(".dashboard-shortcuts-snippets")}],[p.Cb,S.toggleMarkdownPreview],[p.b,S.focusDuoChat]]),Object(u.c)((function(t,e,n){return!Object(p.Hb)(p.Cb).includes(n)&&void 0})),null!==(t=gon)&&void 0!==t&&null!==(t=t.features)&&void 0!==t&&t.findAndReplace&&(this.add(p.d,S.toggleFindAndReplaceBar),Object(u.c)((function(t,e,n){return!Object(p.Hb)(p.d).includes(n)&&void 0}))),i()(document).on("click",".js-shortcuts-modal-trigger",this.onToggleHelp),Object(m.b)()&&Object(m.a)(),this.filterSelectors=["input[type=search]:not(#diff-tree-search)",".gl-filtered-search-term-input",".filtered-search"]}addExtension(t,e=[],n=new Set){n.add(t);let r=this.extensions.get(t);if(!r){for(const e of null!==(o=t.dependencies)&&void 0!==o?o:[]){var o;n.has(e)||e===S||(n.add(e),this.addExtension(e,[],n))}r=new t(this,...e),this.extensions.set(t,r)}return n.delete(t),r}add(t,e){u.b.bind(Object(p.Hb)(t),e)}addAll(t){var e=this;t.forEach((function(t){return e.add(...t)}))}onToggleHelp(t){var e=this;null!=t&&t.preventDefault&&t.preventDefault(),this.helpModalElement&&this.helpModalVueInstance?(this.helpModalVueInstance.$destroy(),this.helpModalElement.remove(),this.helpModalElement=null,this.helpModalVueInstance=null):(this.helpModalElement=document.createElement("div"),document.body.append(this.helpModalElement),this.helpModalVueInstance=new c.default({el:this.helpModalElement,components:{ShortcutsHelp:function(){return Promise.all([n.e("77a00e0c"),n.e("e440161e"),n.e("85a2dfb8"),n.e("7e6a3f1a"),n.e("2b5e4ff1")]).then(n.bind(null,"exIq"))}},render:function(t){return t("shortcuts-help",{on:{hidden:e.onToggleHelp}})}}))}static onTogglePerfBar(t){t.preventDefault();Object(d.H)(Object(d.j)("perf_bar_enabled"))?Object(d.O)("perf_bar_enabled","false",{path:"/"}):Object(d.O)("perf_bar_enabled","true",{path:"/"}),Object(g.I)()}static onToggleCanary(t){t.preventDefault();const e=Object(d.H)(Object(d.j)("gitlab_canary"));Object(d.O)("gitlab_canary",(!e).toString(),{expires:365,path:"/"}),Object(g.I)()}static toggleMarkdownPreview(t){i()(document).triggerHandler("markdown-preview:toggle",[t])}static toggleFindAndReplaceBar(t){i()(document).triggerHandler("markdown-editor:find-and-replace",[t])}focusFilter(t){const e=document.querySelectorAll(this.filterSelectors.join(",")),n=Array.from(e).find((function(t){return t.offsetParent}));null==n||n.focus(),t.preventDefault()}static focusSearch(t){var e;null===(e=document.querySelector("#super-sidebar-search"))||void 0===e||e.click(),a.a.trackEvent("press_keyboard_shortcut_to_activate_command_palette"),t.preventDefault&&t.preventDefault()}static async focusSearchFile(t){var e,n;if(!/^projects:/.test(document.body.dataset.page))return;null!=t&&t.key&&a.a.trackEvent(l.f),null==t||t.preventDefault(),null===(e=document.querySelector("#super-sidebar-search"))||void 0===e||e.click();const r=await Object(f.n)("#super-sidebar-search-modal #search");if(!r)return;const o=null===(n=document.querySelector(".js-repo-breadcrumbs"))||void 0===n?void 0:n.dataset.currentPath;r.value="~"+(o?o+"/":""),r.dispatchEvent(new Event("input"))}static hideAppearingContent(t){document.querySelectorAll(".tooltip, .popover").forEach((function(t){t.style.display="none"})),t.preventDefault&&t.preventDefault()}static focusDuoChat(t){var e;null===(e=document.querySelector(".js-tanuki-bot-chat-toggle"))||void 0===e||e.click(),t.preventDefault&&t.preventDefault()}static initMarkdownEditorShortcuts(t,e){const n=v(t),r=new u.b(t[0]);t.data(b,r),n.forEach((function(t,n){r.bind(t,(function(t){t.preventDefault(),e(n)}))}));const s=o()([...n.values()]),i=u.b.prototype.stopCallback;r.stopCallback=function(t,e,n){return!s.includes(n)&&i.call(this,t,e,n)}}static removeMarkdownEditorShortcuts(t){const e=t.data(b);e&&v(t).forEach((function(t){e.unbind(t)}))}}}}]);
//# sourceMappingURL=540c13ba.410c6bb4.chunk.js.map