(this.webpackJsonp=this.webpackJsonp||[]).push([["8112495f"],{D2zM:function(e,t,n){"use strict";var r=n("zIFf"),i=n("7e18"),s=n("CbCZ"),a=n("2TqH"),o=n("AxB5"),l=n("hvGG"),u=n("E3sI"),c={name:"GlSearchBoxByClick",components:{GlClearIconButton:i.a,GlButton:s.a,GlFormInput:l.a,GlDisclosureDropdown:a.a,GlDisclosureDropdownItem:o.a,GlFormInputGroup:u.a},directives:{GlTooltip:r.a},props:{value:{required:!1,default:"",validator:function(){return!0}},historyItems:{type:Array,required:!1,default:null},placeholder:{type:String,required:!1,default:"Search"},clearable:{type:Boolean,required:!1,default:!0},disabled:{type:Boolean,required:!1,default:!1},recentSearchesHeader:{type:String,required:!1,default:"Recent searches"},clearButtonTitle:{type:String,required:!1,default:"Clear"},closeButtonTitle:{type:String,required:!1,default:"Close"},clearRecentSearchesText:{type:String,required:!1,default:"Clear recent searches"},noRecentSearchesText:{type:String,required:!1,default:"You don't have any recent searches"},tooltipContainer:{required:!1,default:!1,validator:function(e){return!1===e||"string"==typeof e||e instanceof HTMLElement}},searchButtonAttributes:{type:Object,required:!1,default:function(){return{}}},showSearchButton:{type:Boolean,required:!1,default:!0}},data:()=>({currentValue:null,isFocused:!1}),computed:{inputAttributes(){const e={type:"search",placeholder:this.placeholder,...this.$attrs};return e["aria-label"]||(e["aria-label"]=e.placeholder),e},hasValue(){return Boolean(this.currentValue)}},watch:{value:{handler(e){this.currentValue=e},immediate:!0},currentValue(e){e!==this.value&&this.$emit("input",e)}},methods:{search(e){this.$emit("submit",e)},selectHistoryItem(e){this.currentValue=e,this.$emit("history-item-selected",e),setTimeout((function(){document.activeElement.blur()}))},clearInput(){this.currentValue="",this.$emit("clear"),this.$refs.input&&this.$refs.input.$el.focus()},emitClearHistory(){this.$emit("clear-history")}}},d=n("tBpV"),h=Object(d.a)(c,(function(){var e=this,t=e._self._c;return t("gl-form-input-group",{staticClass:"gl-search-box-by-click",class:{"gl-search-box-by-click-with-search-button":e.showSearchButton},scopedSlots:e._u([e.historyItems?{key:"prepend",fn:function(){return[t("gl-disclosure-dropdown",{ref:"historyDropdown",staticClass:"gl-search-box-by-click-history",attrs:{icon:"history",category:"tertiary","toggle-text":"Toggle search history","text-sr-only":"","fluid-width":"",disabled:e.disabled,"aria-label":"Recent searches history"},scopedSlots:e._u([{key:"header",fn:function(){return[t("div",{staticClass:"gl-search-box-by-click-history-header gl-flex gl-min-h-8 gl-grow gl-items-center gl-border-b-1 gl-border-b-dropdown-divider !gl-p-4 gl-text-sm gl-font-bold gl-border-b-solid"},[e._v("\n          "+e._s(e.recentSearchesHeader)+"\n        ")])]},proxy:!0},e.historyItems.length?{key:"footer",fn:function(){return[t("div",{staticClass:"gl-flex gl-flex-col gl-border-t-1 gl-border-t-dropdown-divider gl-p-2 gl-border-t-solid"},[t("gl-button",{ref:"clearHistory",staticClass:"!gl-justify-start",attrs:{category:"tertiary"},on:{click:e.emitClearHistory}},[e._v("\n            "+e._s(e.clearRecentSearchesText)+"\n          ")])],1)]},proxy:!0}:null],null,!0)},[e._v(" "),e.historyItems.length?e._l(e.historyItems,(function(n,r){return t("gl-disclosure-dropdown-item",{key:r,staticClass:"gl-search-box-by-click-history-item",attrs:{"aria-label":"Select recent search: "+(n||"empty search")},on:{action:function(t){return e.selectHistoryItem(n)}},scopedSlots:e._u([{key:"list-item",fn:function(){return[e._t("history-item",(function(){return[e._v(e._s(n))]}),{historyItem:n})]},proxy:!0}],null,!0)})})):t("gl-disclosure-dropdown-item",{staticClass:"gl-px-4 gl-py-2 gl-text-sm gl-text-subtle",attrs:{"aria-label":"Select recent search: "+e.noRecentSearchesText}},[e._v("\n        "+e._s(e.noRecentSearchesText)+"\n      ")])],2)]},proxy:!0}:null,e.showSearchButton?{key:"append",fn:function(){return[t("gl-button",e._b({ref:"searchButton",staticClass:"gl-search-box-by-click-search-button",attrs:{category:"tertiary",icon:"search",disabled:e.disabled,"aria-label":"Search","data-testid":"search-button"},on:{click:function(t){return e.search(e.currentValue)}}},"gl-button",e.searchButtonAttributes,!1))]},proxy:!0}:null],null,!0)},[e._v(" "),e._t("input",(function(){return[t("gl-form-input",e._b({ref:"input",staticClass:"gl-search-box-by-click-input",class:{"!gl-rounded-control":!e.showSearchButton},attrs:{disabled:e.disabled},on:{focus:function(t){e.isFocused=!0},blur:function(t){e.isFocused=!1}},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(e.currentValue)}},model:{value:e.currentValue,callback:function(t){e.currentValue=t},expression:"currentValue"}},"gl-form-input",e.inputAttributes,!1))]})),e._v(" "),e.clearable&&e.hasValue&&!e.disabled?t("gl-clear-icon-button",{staticClass:"gl-search-box-by-click-icon-button gl-search-box-by-click-clear-button gl-clear-icon-button",attrs:{title:e.clearButtonTitle,"tooltip-container":e.tooltipContainer,"data-testid":"filtered-search-clear-button"},on:{click:e.clearInput}}):e._e()],2)}),[],!1,null,null,null);t.a=h.exports},jI5q:function(e,t,n){"use strict";n("LdIe"),n("z6RN"),n("PTOk"),n("UezY"),n("hG7+"),n("B++/"),n("47t/"),n("v2fZ"),n("3UXl"),n("iyoE");var r=n("VNnR"),i=n.n(r),s=n("l9Jy"),a=n.n(s),o=n("onSc"),l=n("zIFf"),u=n("mpVB"),c=n("d85j"),d=n("D2zM"),h=n("yxLa"),p=n("47Nv"),y=n("6IH5"),f={name:"GlFilteredSearchTerm",components:{GlFilteredSearchTokenSegment:p.a,GlToken:h.a},inject:["termsAsTokens"],inheritAttrs:!1,props:{availableTokens:{type:Array,required:!0},active:{type:Boolean,required:!1,default:!1},value:{type:Object,required:!1,default:function(){return{data:""}}},placeholder:{type:String,required:!1,default:""},searchInputAttributes:{type:Object,required:!1,default:function(){return{}}},isLastToken:{type:Boolean,required:!1,default:!1},currentValue:{type:Array,required:!1,default:function(){return[]}},cursorPosition:{type:String,required:!1,default:"end",validator:function(e){return["start","end"].includes(e)}},searchTextOptionLabel:{type:String,required:!1,default:y.m.title},viewOnly:{type:Boolean,required:!1,default:!1}},computed:{showInput(){return this.termsAsTokens()||Boolean(this.placeholder)},showToken(){return this.termsAsTokens()&&Boolean(this.value.data)},suggestedTokens(){var e=this;if(this.viewOnly)return[];const t=this.availableTokens.filter((function(t){return"function"==typeof t.match?t.match.call(null,{query:e.value.data,title:t.title,defaultMatcher:y.h}):Object(y.h)(t.title,e.value.data)}));return this.termsAsTokens()&&this.value.data&&t.push({...y.m,title:this.searchTextOptionLabel}),t.map(y.n)},internalValue:{get(){return this.value.data},set(e){this.$emit("input",{data:e})}},eventListeners(){return this.viewOnly?{}:{mousedown:this.stopMousedownOnCloseButton,close:this.destroyByClose}}},methods:{onBackspace(){this.$emit("destroy",{intent:y.a})},stopMousedownOnCloseButton(e){e.target.closest(y.c)&&Object(u.k)(e)},destroyByClose(){this.$emit("destroy")},onComplete(e){e===y.b?this.$emit("complete"):this.$emit("replace",{type:e})}}},k=n("tBpV"),v=Object(k.a)(f,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"gl-filtered-search-term gl-h-auto",attrs:{"data-testid":"filtered-search-term"}},[t("gl-filtered-search-token-segment",{ref:"segment",staticClass:"gl-filtered-search-term-token",attrs:{"is-term":"",active:e.active,"cursor-position":e.cursorPosition,"search-input-attributes":e.searchInputAttributes,"is-last-token":e.isLastToken,"current-value":e.currentValue,"view-only":e.viewOnly,options:e.suggestedTokens},on:{activate:function(t){return e.$emit("activate")},deactivate:function(t){return e.$emit("deactivate")},complete:e.onComplete,backspace:e.onBackspace,submit:function(t){return e.$emit("submit")},split:function(t){return e.$emit("split",t)},previous:function(t){return e.$emit("previous")},next:function(t){return e.$emit("next")}},scopedSlots:e._u([{key:"view",fn:function({label:n}){return[e.showToken?t("gl-token",e._g({class:{"gl-cursor-pointer":!e.viewOnly},attrs:{"view-only":e.viewOnly}},e.eventListeners),[e._v(e._s(e.value.data))]):e.showInput?t("input",e._b({staticClass:"gl-filtered-search-term-input",attrs:{placeholder:e.placeholder,"aria-label":n,readonly:e.viewOnly,disabled:e.viewOnly,"data-testid":"filtered-search-term-input"},on:{focusin:function(t){return e.$emit("activate")},focusout:function(t){return e.$emit("deactivate")}}},"input",e.searchInputAttributes,!1)):[e._v(e._s(e.value.data))]]}}]),model:{value:e.internalValue,callback:function(t){e.internalValue=t},expression:"internalValue"}})],1)}),[],!1,null,null,null).exports;let m=0;function b(){return[Object(y.d)()]}var g={name:"GlFilteredSearch",components:{GlSearchBoxByClick:d.a,GlIcon:c.a,PortalTarget:o.PortalTarget},directives:{GlTooltip:l.a},provide(){var e=this;return m+=1,this.portalName="filters_portal_"+m,{portalName:this.portalName,alignSuggestions:function(t){return e.alignSuggestions(t)},suggestionsListClass:function(){return e.suggestionsListClass},termsAsTokens:function(){return e.termsAsTokens}}},inheritAttrs:!1,props:{value:{required:!1,type:Array,default:function(){return[]}},availableTokens:{type:Array,required:!1,default:function(){return[]},validator(e){if(!e.__v_raw)return!0;const t=Array.isArray(e)&&e.every((function({token:e}){return!e||e.__v_skip}));return t||Object(u.i)("You are using Vue3. In Vue3 each token component passed to filtered search must be wrapped into markRaw",{name:"GlFilteredSearch"}),t}},placeholder:{type:String,required:!1,default:"Search"},clearButtonTitle:{type:String,required:!1,default:"Clear"},historyItems:{type:Array,required:!1,default:null},suggestionsListClass:{type:[String,Array,Object],required:!1,default:null},showFriendlyText:{type:Boolean,required:!1,default:!1},searchButtonAttributes:{type:Object,required:!1,default:function(){return{}}},searchInputAttributes:{type:Object,required:!1,default:function(){return{}}},viewOnly:{type:Boolean,required:!1,default:!1},termsAsTokens:{type:Boolean,required:!1,default:!1},searchTextOptionLabel:{type:String,required:!1,default:y.m.title},showSearchButton:{type:Boolean,required:!1,default:!0}},data:()=>({tokens:b(),activeTokenIdx:null,suggestionsStyle:{},intendedCursorPosition:"end"}),computed:{activeToken(){return this.tokens[this.activeTokenIdx]},appliedTokens(){return this.tokens.filter((function(e){return!Object(y.g)(e)}))},lastTokenIdx(){return this.tokens.length-1},isLastTokenActive(){return this.activeTokenIdx===this.lastTokenIdx},hasValue(){return this.tokens.length>1||""!==this.tokens[0].value.data},termPlaceholder(){return this.hasValue?null:this.placeholder},currentAvailableTokens(){var e=this;return this.availableTokens.filter((function(t){return!t.disabled&&(!t.unique||!e.tokens.find((function(e){return e.type===t.type})))}))}},watch:{tokens:{handler(){0!==this.tokens.length&&this.isLastTokenEmpty()||this.viewOnly||this.tokens.push(Object(y.d)()),this.$emit("input",this.tokens)},deep:!0,immediate:!0},value:{handler(e,t){if(!i()(e,t)){const t=e.length?e:b();this.applyNewValue(a()(t))}},deep:!0,immediate:!0}},methods:{applyNewValue(e){this.tokens=Object(y.i)(e)?Object(y.e)(e,this.termsAsTokens):e},isActiveToken(e){return this.activeTokenIdx===e},isLastToken(e){return null===this.activeTokenIdx&&e===this.lastTokenIdx},isLastTokenEmpty(){return Object(y.g)(this.tokens[this.lastTokenIdx])},getTokenEntry(e){return this.availableTokens.find((function(t){return t.type===e}))},getTokenComponent(e){var t;return(null===(t=this.getTokenEntry(e))||void 0===t?void 0:t.token)||v},getTokenClassList(e){return{"gl-filtered-search-item":!0,"gl-filtered-search-last-item":this.isLastToken(e)&&!this.viewOnly}},activate(e){this.viewOnly||(this.activeTokenIdx=e)},activatePreviousToken(){this.activeTokenIdx>0&&(this.activeTokenIdx-=1,this.intendedCursorPosition="end")},activateNextToken(){this.activeTokenIdx<this.value.length&&(this.activeTokenIdx+=1,this.intendedCursorPosition="start")},alignSuggestions(e){const t=e.getBoundingClientRect().left,n=this.$el.getBoundingClientRect().left,r=`translateX(${Math.floor(t-n)}px)`;this.suggestionsStyle={transform:r}},deactivate(e){this.intendedCursorPosition="end";const t=this.tokens.indexOf(e);-1!==t&&this.activeTokenIdx===t&&(this.isLastTokenEmpty()||this.tokens.push(Object(y.d)()),!this.isLastTokenActive&&Object(y.g)(this.activeToken)&&this.tokens.splice(t,1),this.activeTokenIdx=null)},destroyToken(e,{intent:t}={}){if(1===this.tokens.length)return;const[n]=this.tokens.splice(e,1);this.$emit("token-destroy",n),t===y.a?this.activeTokenIdx=Math.max(e-1,0):e<this.activeTokenIdx?this.activeTokenIdx-=1:e===this.activeTokenIdx&&(this.activeTokenIdx=null)},replaceToken(e,t){this.$set(this.tokens,e,Object(y.f)({...t,value:{data:"",...t.value}})),this.activeTokenIdx=e},createTokens(e,t=[""]){if(!this.isLastTokenActive&&1===t.length&&""===t[0])return void(this.activeTokenIdx=this.lastTokenIdx);const n=t.map((function(e){return Object(y.d)(e)}));this.tokens.splice(e+1,0,...n),this.activeTokenIdx=e+t.length},completeToken(){this.$emit("token-complete",this.activeToken),this.activeTokenIdx===this.lastTokenIdx-1?this.activeTokenIdx=this.lastTokenIdx:this.activeTokenIdx=null},submit(){this.$emit("submit",Object(y.j)(a()(this.tokens)))}}},T=Object(k.a)(g,(function(){var e=this,t=e._self._c;return t("gl-search-box-by-click",e._b({attrs:{value:e.tokens,"history-items":e.historyItems,clearable:e.hasValue,"search-button-attributes":e.searchButtonAttributes,"show-search-button":e.showSearchButton,disabled:e.viewOnly,"data-testid":"filtered-search-input"},on:{submit:e.submit,input:e.applyNewValue,"history-item-selected":function(t){return e.$emit("history-item-selected",t)},clear:function(t){return e.$emit("clear")},"clear-history":function(t){return e.$emit("clear-history")}},scopedSlots:e._u([{key:"history-item",fn:function(t){return[e._t("history-item",null,null,t)]}},{key:"input",fn:function(){return[t("div",{staticClass:"gl-filtered-search-scrollable-container",class:{"gl-filtered-search-scrollable-container-with-search-button":e.showSearchButton,"gl-filtered-search-view-only":e.viewOnly}},[t("div",{staticClass:"gl-filtered-search-scrollable"},e._l(e.tokens,(function(n,r){return t(e.getTokenComponent(n.type),{key:n.id,ref:"tokens",refInFor:!0,tag:"component",class:e.getTokenClassList(r),attrs:{config:e.getTokenEntry(n.type),active:e.activeTokenIdx===r,"cursor-position":e.intendedCursorPosition,"available-tokens":e.currentAvailableTokens,"current-value":e.tokens,index:r,placeholder:e.termPlaceholder,"show-friendly-text":e.showFriendlyText,"search-input-attributes":e.searchInputAttributes,"view-only":e.viewOnly,"is-last-token":e.isLastToken(r),"search-text-option-label":e.searchTextOptionLabel,"applied-tokens":e.appliedTokens},on:{activate:function(t){return e.activate(r)},deactivate:function(t){return e.deactivate(n)},destroy:function(t){return e.destroyToken(r,t)},replace:function(t){return e.replaceToken(r,t)},complete:e.completeToken,submit:e.submit,split:function(t){return e.createTokens(r,t)},previous:e.activatePreviousToken,next:e.activateNextToken},model:{value:n.value,callback:function(t){e.$set(n,"value",t)},expression:"token.value"}})})),1)]),e._v(" "),t("portal-target",{key:e.activeTokenIdx,ref:"menu",style:e.suggestionsStyle,attrs:{name:e.portalName,slim:""}})]},proxy:!0}],null,!0)},"gl-search-box-by-click",e.$attrs,!1))}),[],!1,null,null,null);t.a=T.exports}}]);
//# sourceMappingURL=8112495f.f0aa2a91.chunk.js.map